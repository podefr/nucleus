<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Nucleus by podefr</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Nucleus</h1>
        <p>It binds your JS logic with the DOM by adding configuration data in the markup</p>

        <p class="view"><a href="https://github.com/podefr/nucleus">View the Project on GitHub <small>podefr/nucleus</small></a></p>


        <ul>
          <li><a href="https://github.com/podefr/nucleus/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/podefr/nucleus/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/podefr/nucleus">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>Nucleus binds your JS logic to the DOM by adding configuration to the markup</h2>

<p>Ever wanted to bind your JS logic to the DOM by doing something like this in your HTML?</p>

<div class="highlight"><pre>    <span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">"value: name"</span><span class="nt">&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">data-listen=</span><span class="s">"click: doSomething"</span><span class="nt">&gt;&lt;/button&gt;</span>
</pre></div>

<p>Nucleus allows you to do just that. It will create the link between your HTML and your JavaScript logic.</p>

<p>Let's start with a simple example. We would like to set the value of "name" in the paragraph.</p>

<h3>HTML</h3>

<div class="highlight"><pre>    <span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">"value: name"</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>

<h3>JavaScript</h3>

<div class="highlight"><pre>    <span class="c1">// The object to display in the DOM</span>
    <span class="kd">var</span> <span class="nx">someone</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">// This is the value that we want to display in the paragraph</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s2">"John"</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">"Doe"</span>
    <span class="p">};</span>

    <span class="c1">// We start by initializing Nucleus</span>
    <span class="kd">var</span> <span class="nx">nucleus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Nucleus</span><span class="p">();</span>

    <span class="c1">// Then we add a nucleus plugin called 'bind'</span>
    <span class="nx">nucleus</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"bind"</span><span class="p">,</span> <span class="p">{</span>

        <span class="c1">// Which has a method called value</span>
        <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// That will set the innerText of the dom to "John"</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="nx">someone</span><span class="p">[</span><span class="nx">param</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="c1">// Then we tell it where to find the DOM elements to bind</span>
    <span class="nx">nucleus</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"p"</span><span class="p">));</span>
</pre></div>

<p>Nucleus will actually create this relationship:</p>

<p><img src="https://raw.github.com/podefr/nucleus/master/schema.png" alt="Schema"></p>

<p>Where data-bind is configured while adding the plugin to nucleus. We could have used any other allowed name, such as 'listen', 'style', 'css', 'text' or even 'another-plugin_for-nucleus'.</p>

<p>Nucleus will then execute the method 'value' in the plugin 'bind', passing it two things:</p>

<ul>
<li>{HTMLElement} the node to which the data-attribute is applied</li>
<li>{String} the parameters specified in the data-attribute, after the name of the method (name in our case)</li>
</ul><p>We've just bound some JS logic to a dom element. This seems overkill for such simple task, but it'll make more sense when we'll add more plugins, and especially when they are plugins that we can just reuse.</p>

<p>Let's add more plugins, one for setting data into the DOM, one for listening to DOM events.</p>

<h3>HTML</h3>

<div class="highlight"><pre>    <span class="nt">&lt;section&gt;</span>
        <span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">"value: name"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">data-listen=</span><span class="s">"click: doSomething"</span><span class="nt">&gt;&lt;/button&gt;</span>
    <span class="nt">&lt;/section&gt;</span>
</pre></div>

<p>In this case, we have two plugins, one called 'bind', and the other one called 'listen'. We can configure Nucleus to accept more than one plugin by calling the 'addAll' method instead of just 'add':</p>

<div class="highlight"><pre>    <span class="c1">// This is some UI with a doSomething method:</span>
    <span class="kd">var</span> <span class="nx">ui</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">doSomething</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// do something</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">nucleus</span><span class="p">.</span><span class="nx">addAll</span><span class="p">({</span>
        <span class="c1">// This is the plugin that we have seen before</span>
        <span class="nx">bind</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="nx">someone</span><span class="p">[</span><span class="nx">param</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="c1">// This is the new plugin called listen</span>
        <span class="nx">listen</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">click</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"click"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">ui</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">event</span><span class="p">);</span>
                <span class="p">},</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
</pre></div>

<p>We still have the same plugin for adding data to the DOM. We also have added a new plugin called 'listen' that adds an eventListener to the targeted DOM. Whenever the user clicks on this DOM element, it will call the method 'doSomething' on UI.</p>

<p>Of course, this example is very limited, as we can't bind a value from an object to something else than innerText, and we can't listen to another event than 'click' as long as we don't create new functions for handling them. Moreover, we can't change the object from which we get the value, nor can we change the object on which to call the method when a click occurs.</p>

<p>So let's create some reusable plugins. We pretend that the object that contains the data is a backbone.Model, which triggers events whenever something changes. We could also call a method on a backbone.View when a click occurs.</p>

<h3>HTML</h3>

<div class="highlight"><pre>    <span class="nt">&lt;section&gt;</span>
        <span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">"change: name, innerText"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">data-event=</span><span class="s">"listen: click, alert, name"</span><span class="nt">&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;/section&gt;</span>
</pre></div>

<h3>JavaScript</h3>

<div class="highlight"><pre>    <span class="c1">// We have a backbone.Model</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"Nucleus"</span><span class="p">);</span>

    <span class="c1">// We have a backbone.View with an alert method. It alerts the value of "name"</span>
    <span class="nx">view</span><span class="p">.</span><span class="nx">alert</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">     * We create a constructor for a binding plugin</span>
<span class="cm">     * It takes a model as a parameter so it knows where to get the data</span>
<span class="cm">     */</span>
    <span class="kd">function</span> <span class="nx">Binding</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// This is the change method of our plugin</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">change</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">attribute</span><span class="p">)</span> <span class="p">{</span>

            <span class="c1">// We need to set the innerText of the DOM to the current value</span>
            <span class="nx">node</span><span class="p">[</span><span class="nx">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>

            <span class="c1">// Whenever the value changes, we update the dom</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:"</span> <span class="o">+</span> <span class="nx">key</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">[</span><span class="nx">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newValue</span><span class="p">;</span>
            <span class="p">});</span>

        <span class="p">};</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Then we create a constructor for an event plugin</span>
<span class="cm">     * It takes a view as parameter, so it knows where to call the method</span>
<span class="cm">     */</span>
    <span class="kd">function</span> <span class="nx">Event</span><span class="p">(</span><span class="nx">view</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">event</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">methodName</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">view</span><span class="p">[</span><span class="nx">methodName</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span> <span class="nx">param</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">};</span>

    <span class="p">}</span>

    <span class="c1">// We create our Nucleus</span>
    <span class="kd">var</span> <span class="nx">nucleus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Nucleus</span><span class="p">();</span>

    <span class="c1">// Then we add our plugins</span>
    <span class="nx">nucleus</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>

        <span class="c1">// We initialize a new binding plugin with the model we want to listen to</span>
        <span class="s2">"bind"</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Binding</span><span class="p">(</span><span class="nx">model</span><span class="p">),</span>

        <span class="c1">// We initialize a new event plugin with the view we want to call the methods on</span>
        <span class="s2">"event"</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Event</span><span class="p">(</span><span class="nx">view</span><span class="p">)</span>

    <span class="p">});</span>

    <span class="c1">// And finally, we apply it to the parent element of the DOM that we want to bind to this logic</span>
    <span class="nx">nucleus</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"section"</span><span class="p">)</span> <span class="p">);</span>
</pre></div>

<p>In this more complete example, we have a Binding plugin that will listen to changes on a backbone.Model to update the DOM. We have created a reusable data-binding plugin that can now be reused to bind as many backbone.Model as we want to our DOM. We have even specified which property of the DOM node we want to update. It could be the className, or even value for form elements!</p>

<p>Then we have created an Event listener that will listen to 'click', or any other event we want to listen to, and forward the event to the method of the view that we have initialized the plugin with.</p>

<p>We can also call multiple methods on the same DOM element:</p>

<div class="highlight"><pre>    <span class="nt">&lt;p</span> <span class="na">data-plugin=</span><span class="s">"method1: param1, param2, paramN; method2: param1, param2, paramN"</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>

<p>Or we can call multiple plugins on the same DOM element</p>

<div class="highlight"><pre>    <span class="nt">&lt;p</span> <span class="na">data-plugin1=</span><span class="s">"method: param1, param2"</span> <span class="na">data-plugin2=</span><span class="s">"method1: param1, param2; method2, param1, param2"</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>

<h2>How to install it?</h2>

<h3>You have require.js:</h3>

<div class="highlight"><pre>    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"require.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

<div class="highlight"><pre>    <span class="nx">require</span><span class="p">([</span><span class="s2">"path/to/Nucleus"</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Nucleus</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">nucleus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Nucleus</span><span class="p">();</span>
    <span class="p">});</span>
</pre></div>

<h3>You want to use it as a standalone:</h3>

<div class="highlight"><pre>    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"Nucleus-standalone.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

<div class="highlight"><pre>    <span class="c1">// Nucleus is packed with AlmondJS, it still doesn't leak to the Global Object</span>
    <span class="c1">// but you have access to Almond's require/define, so you can do</span>
    <span class="nx">require</span><span class="p">([</span><span class="s2">"Nucleus"</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Nucleus</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">nucleus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Nucleus</span><span class="p">();</span>
    <span class="p">});</span>
</pre></div>

<h3>You have jquery:</h3>

<div class="highlight"><pre>    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"jquery.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"Nucleus-jquery.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

<div class="highlight"><pre>    <span class="c1">// Nucleus-jquery is also packed with AlmondJS. When requireing the plugin</span>
    <span class="c1">// it will give you a reference to Jquery which will have the nucleus plugin</span>
    <span class="nx">require</span><span class="p">([</span><span class="s2">"Nucleus-jquery"</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// We select the parent DOM node where we want to apply our plugins.</span>
        <span class="c1">// Nucleus.apply() will be called on all of the elements returned by the $()</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'section'</span><span class="p">).</span><span class="nx">nucleus</span><span class="p">({</span>

            <span class="c1">// And we give the list of plugins. Nucleus.addAll will be called with this object.</span>
            <span class="s1">'contact'</span><span class="o">:</span> <span class="p">{</span>
                <span class="s1">'firstname'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">node</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="s2">"Nucleus"</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">});</span>

    <span class="p">});</span>
</pre></div>

<h2>Are there existing nucleus plugins?</h2>

<p>Actually yes! Olives is a JS library that has cool nucleus plugins, such as double way binding and DOM event listener with delegation. <a href="https://github.com/flams/olives">https://github.com/flams/olives</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/podefr">podefr</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-38206569-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>